knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>% group_by(CLETA5) %>% summarize(somma =sum(count[!is.na(somma_mutuoin3))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>% group_by(CLETA5) %>% summarize(somma =sum(count[!is.na(somma_mutuoin3)))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(count[!is.na(somma_mutuoin3)]))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(count_var[!is.na(somma_mutuoin3)]))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(!is.na(somma_mutuoin3)))
knitr::opts_chunk$set(echo = TRUE)
27+84+152+169+130
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>% group_by(CLETA5) %>% summarize(somma = sum(!is.na(somma_mutuoin3)), tot_fascia_eta = sum(CLETA5), tot_mutuo_fascia_eta = somma/tot_fascia_eta)))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>% group_by(CLETA5) %>% summarize(somma = sum(!is.na(somma_mutuoin3)), tot_fascia_eta = sum(CLETA5), tot_mutuo_fascia_eta = somma/tot_fascia_eta))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = sum(CLETA5),
tot_mutuo_fascia_eta = somma / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
carcom20 %>% filter(CLETA5==1)
knitr::opts_chunk$set(echo = TRUE)
carcom20 %>% filter(CLETA5==2)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = count(CLETA5),
tot_mutuo_fascia_eta = somma / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = sum(CLETA5),
tot_mutuo_fascia_eta = somma / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(somma = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_mutuo_fascia_eta = somma / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_mutuo_fascia_eta = somma / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_mutuo_fascia_eta = mutuo_count / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
rfam20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/rfam20.csv", sep=";")
knitr::opts_chunk$set(echo = TRUE)
rfam20
knitr::opts_chunk$set(echo = TRUE)
setwd("C:\\Users\\Alberto-PC\\Downloads\\ind20_ascii\\CSV")
rfam20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/rfam20.csv", sep=";")
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/Alberto-PC/Downloads/ind20_ascii/CSV")
rfam20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/rfam20.csv", sep=";")
rfam20
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/Alberto-PC/Downloads/ind20_ascii/CSV")
rfam20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/rfam20.csv", sep=",")
rfam20
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta)
knitr::opts_chunk$set(echo = TRUE)
27/280
knitr::opts_chunk$set(echo = TRUE)
left_join(debito, rfam20, by = "NQUEST")
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res = left_join(debito, rfam20, by = "NQUEST")
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
income_tot = sum(Y),
debt_to_disposable_income = mutuo_count / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
income_tot = sum(Y),
debt_to_disposable_income = mutuo_count / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res = left_join(carcom_tot, rfam20, by = "NQUEST")
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
income_tot = sum(Y),
debt_to_disposable_income = mutuo_count / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_mutuo_fascia = sum(somma_mutuoin3),
income_tot = sum(Y),
debt_to_disposable_income = mutuo_count / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_mutuo_fascia = sum(somma_mutuoin3),
income_tot = sum(Y),
debt_to_disposable_income = somma_mutuo_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_mutuo_fascia = sum(somma_mutuoin3, na.rm = T),
income_tot = sum(Y),
debt_to_disposable_income = somma_mutuo_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(somma_mutuoin3, na.rm = T),
income_tot = sum(Y),
debt_to_disposable_income = somma_mutuo_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(somma_mutuoin3, na.rm = T),
income_tot = sum(Y),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(income_tot = sum(Y, na.rm = T))
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(income_tot = sum(Y))
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
sum(Y)
knitr::opts_chunk$set(echo = TRUE)
sum(rfam20$Y)
knitr::opts_chunk$set(echo = TRUE)
sum(reddito_debito_res$Y)
knitr::opts_chunk$set(echo = TRUE)
alld2_fam %>% group_by(DEBM3) %>% summarize(n = n(),
somma_mutuo3 = sum(MUTUOIN3),
mean_mutuo3 = mean(MUTUOIN3),
mean_tdebita3 = mean(TDEBITA3),
somma_tdebita3 = sum(TDEBITA3),
mean_taeg = mean(TAEG3),
tasso_medio_ponderato_taeg =(sum(TAEG3*MUTUOIN3)/sum(MUTUOIN3))
)
knitr::opts_chunk$set(echo = TRUE)
debiti20
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res$CLETA5 = factor(reddito_debito_res$CLETA5,
levels = c('1'='fino a 34 anni',
'2'='35-44',
'3'='45-54',
'4'='55-64',
'5'='oltre 64'))
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res = left_join(carcom_tot, rfam20, by = "NQUEST")
reddito_debito_res$CLETA5 = factor(reddito_debito_res$CLETA5,
levels = c(1='fino a 34 anni',
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res$CLETA5 = factor(reddito_debito_res$CLETA5,
levels = c('1'='fino a 34 anni',
'2'='35-44',
'3'='45-54',
'4'='55-64',
'5'='oltre 64'))
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
reddito_debito_res = left_join(carcom_tot, rfam20, by = "NQUEST")
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
glimpse(reddito_debito_res)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res$CLETA5 <- recode(reddito_debito_res$CLETA5, 1='fino a 34 anni',
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res$CLETA5 <- factor(reddito_debito_res$CLETA5,
levels = c(1, 2, 3, 4, 5),
labels = c('fino a 34 anni',
'35-44',
'45-54',
'55-64',
'oltre 64'))
reddito_debito_res %>%
group_by(CLETA5) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot$CLETA5 <- factor(carcom_tot$CLETA5,
levels = c(1, 2, 3, 4, 5),
labels = c('fino a 34 anni',
'35-44',
'45-54',
'55-64',
'oltre 64'))
carcom_tot %>%
group_by(CLETA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta,
)
knitr::opts_chunk$set(echo = TRUE)
percent_residual_debt_transportation <- sum(debiti20$TDEBITC, na.rm = TRUE) / sum(debiti20$PFCONS, na.rm = TRUE)
percent_residual_debt_durable <- sum(debiti20$TDEBITD, na.rm = TRUE) / sum(debiti20$PFCONS, na.rm = TRUE)
percent_residual_debt_nondurable <- sum(debiti20$TDEBITE, na.rm = TRUE) / sum(debiti20$PFCONS, na.rm = TRUE)
percent_residual_debt_other_everydayexpenses <- sum(debiti20$TDEBITF, na.rm = TRUE) / sum(debiti20$PFCONS, na.rm = TRUE)
percent_residual_debt_education <- sum(debiti20$TDEBITG, na.rm = TRUE) / sum(debiti20$PFCONS, na.rm = TRUE)
perc <- data.frame(
"Percent_residual_debt" = c(
"Transportation" = percent_residual_debt_transportation,
"Durable" = percent_residual_debt_durable,
"Non-durable" = percent_residual_debt_nondurable,
"Other Everyday Expenses" = percent_residual_debt_other_everydayexpenses,
"Education" = percent_residual_debt_education))
print(perc)
percentages <- c(
"Transportation" = percent_residual_debt_transportation,
"Durable" = percent_residual_debt_durable,
"Non-durable" = percent_residual_debt_nondurable,
"Other Everyday Expenses" = percent_residual_debt_other_everydayexpenses,
"Education" = percent_residual_debt_education)
df <- data.frame(
group = names(percentages),
value = percentages)
pie_chart <- ggplot(df, aes(x = "", y = value, fill = group)) +
geom_bar(stat = "identity", width = 1, color = "white") +
coord_polar("y", start = 0) +
ggtitle("Percentage of Residual Debt by Category") +
theme_void()
print(pie_chart)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(NPERC) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(QUAL) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
reddito_debito_res %>%
group_by(QUAL) %>%
summarize(somma_deb_res_fascia = sum(PFCONS, na.rm = T),
income_tot = sum(Y, na.rm = T),
debt_to_disposable_income = somma_deb_res_fascia / income_tot,
)
knitr::opts_chunk$set(echo = TRUE)
alld2_fam$TIPOTAX3 <- factor(alld2_fam$TIPOTAX3,
levels = c(1, 2, 3),
labels = c('Fisso',
'Variabile',
'Zero'))
alld2_fam %>% group_by(TIPOTAX3) %>% summarize(n = n(),
somma_mutuo3 = sum(MUTUOIN3),
mean_mutuo3 = mean(MUTUOIN3),
mean_tdebita3 = mean(TDEBITA3),
somma_tdebita3 = sum(TDEBITA3),
mean_taeg = mean(TAEG3),
tasso_medio_ponderato =(sum(TAEG3*MUTUOIN3)/sum(MUTUOIN3))
)
knitr::opts_chunk$set(echo = TRUE)
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)",))
knitr::opts_chunk$set(echo = TRUE)
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)",))
knitr::opts_chunk$set(echo = TRUE)
levels(alld2_fam$DEBM3)
knitr::opts_chunk$set(echo = TRUE)
levels(factor(alld2_fam$DEBM3))
knitr::opts_chunk$set(echo = TRUE)
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)",))
knitr::opts_chunk$set(echo = TRUE)
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)"))
alld2_fam %>% group_by(DEBM3) %>% summarize(mean_anni_durata_mutuo = mean(MUTUODU3))
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(AREA3) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta,
)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(AREA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta,
)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot$CLETA5 <- factor(carcom_tot$CLETA5,
levels = c(1, 2, 3, 4, 5),
labels = c('Nord Ovest',
'Nord Est',
'Centro',
'Sud',
'Isole'))
carcom_tot %>%
group_by(AREA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta,
)
carcom_tot$CLETA5 <- factor(carcom_tot$CLETA5,
levels = c(1, 2, 3, 4, 5),
labels = c('fino a 34 anni',
'35-44',
'45-54',
'55-64',
'oltre 64'))
carcom_tot %>%
group_by(CLETA5) %>%
summarize(tot_richiesta_mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta,
)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot %>%
group_by(CLETA5) %>%
summarize(tot_richiesta_mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = tot_richiesta_mutuo_count / tot_fascia_eta,
)
carcom20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/carcom20.csv", sep=";")
debiti20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/debiti20.csv", sep=";")
alld2_res <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_res.csv", sep=";")
alld2_prof <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_prof.csv", sep=";")
alld2_fam <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_fam.csv", sep=";")
alld2_aimm <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_aimm.csv", sep=";")
carcom20 = filter(carcom20, CFRED == 1)
alld2_fam[is.na(alld2_fam)] <- 0
alld2_fam %>% group_by(DEBM3) %>% summarize(n = n(),
somma_mutuo3 = sum(MUTUOIN3),
mean_mutuo3 = mean(MUTUOIN3),
mean_tdebita3 = mean(TDEBITA3),
somma_tdebita3 = sum(TDEBITA3),
mean_taeg = mean(TAEG3),
tasso_medio_ponderato_taeg =(sum(TAEG3*MUTUOIN3)/sum(MUTUOIN3))
)
alld2_fam$TIPOTAX3 <- factor(alld2_fam$TIPOTAX3,
levels = c(1, 2, 3),
labels = c('Fisso',
'Variabile',
'Zero'))
alld2_fam %>% group_by(TIPOTAX3) %>% summarize(n = n(),
somma_mutuo3 = sum(MUTUOIN3),
mean_mutuo3 = mean(MUTUOIN3),
mean_tdebita3 = mean(TDEBITA3),
somma_tdebita3 = sum(TDEBITA3),
mean_taeg = mean(TAEG3),
tasso_medio_ponderato =(sum(TAEG3*MUTUOIN3)/sum(MUTUOIN3))
)
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)"))
alld2_fam %>% group_by(DEBM3) %>% summarize(mean_anni_durata_mutuo = mean(MUTUODU3))
somma_mutuo = alld2_fam %>% group_by(NQUEST) %>% summarize(somma_mutuoin3 = sum(MUTUOIN3))
debito = inner_join(debiti20, somma_mutuo, by = "NQUEST")
carcom_tot = left_join(carcom20, debito, by = "NQUEST")
carcom_tot$CLETA5 <- factor(carcom_tot$CLETA5,
levels = c(1, 2, 3, 4, 5),
labels = c('fino a 34 anni',
'35-44',
'45-54',
'55-64',
'oltre 64'))
carcom_tot %>%
group_by(CLETA5) %>%
summarize(tot_richiesta_mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = tot_richiesta_mutuo_count / tot_fascia_eta,
)
knitr::opts_chunk$set(echo = TRUE)
carcom_tot$AREA5 <- factor(carcom_tot$AREA5,
levels = c(1, 2, 3, 4, 5),
labels = c('Nord Ovest',
'Nord Est',
'Centro',
'Sud',
'Isole'))
carcom_tot %>%
group_by(AREA5) %>%
summarize(mutuo_count = sum(!is.na(somma_mutuoin3)),
tot_fascia_eta = n(),
tot_creditoconsumo_fascia_eta = mutuo_count / tot_fascia_eta,
)
knitr::opts_chunk$set(echo = TRUE)
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)"))
alld2_fam %>% group_by(DEBM3) %>% summarize(n = n(),
somma_mutuo3 = sum(MUTUOIN3),
mean_mutuo3 = mean(MUTUOIN3),
mean_tdebita3 = mean(TDEBITA3),
somma_tdebita3 = sum(TDEBITA3),
mean_taeg = mean(TAEG3),
tasso_medio_ponderato_taeg =(sum(TAEG3*MUTUOIN3)/sum(MUTUOIN3))
)
carcom20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/carcom20.csv", sep=";")
debiti20 <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/debiti20.csv", sep=";")
alld2_res <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_res.csv", sep=";")
alld2_prof <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_prof.csv", sep=";")
alld2_fam <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_fam.csv", sep=";")
alld2_aimm <- read.csv("~/GitHub/Economical-risk-project/Indagine_2020/alld2_aimm.csv", sep=";")
carcom20 = filter(carcom20, CFRED == 1)
alld2_fam[is.na(alld2_fam)] <- 0
alld2_fam$DEBM3 <- factor(alld2_fam$DEBM3,
levels = c(1, 2, 3, 4, 5),
labels = c("acquisto di mezzi di trasporto (come auto, moto)",
"acquisto di altri beni durevoli (come elettronica, mobili, elettrodomestici, ecc.)",
"acquisto di beni non durevoli (vacanze, ecc..)",
"altri acquisti o spese quotidiane",
"spese di istruzione (laurea, master)"))
alld2_fam %>% group_by(DEBM3) %>% summarize(n = n(),
somma_mutuo3 = sum(MUTUOIN3),
mean_mutuo3 = mean(MUTUOIN3),
mean_tdebita3 = mean(TDEBITA3),
somma_tdebita3 = sum(TDEBITA3),
mean_taeg = mean(TAEG3),
tasso_medio_ponderato_taeg =(sum(TAEG3*MUTUOIN3)/sum(MUTUOIN3))
)
